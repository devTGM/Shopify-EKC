{% doc %}
  @prompt
    Create a premium testimonial carousel section for a Shopify homepage with a luxury, minimal aesthetic.
    
    Section Structure
    
    Header Area (Centered)
    
    Headline (editable text)
    
    Short subheading (editable text)
    
    Testimonial Carousel
    
    General Behavior
    
    Horizontally scrolling carousel
    
    Smooth auto-scroll from right to left
    
    Infinite loop
    
    Pause on hover (desktop)
    
    Manual control enabled:
    
    Cursor / drag control on desktop
    
    Touch / swipe control on mobile
    
    Auto-scroll resumes after manual interaction
    
    Option to enable / disable auto-scroll via setting
    
    Testimonial Cards
    
    Each card must include:
    
    Customer image or video (Shopify media selector)
    
    Video options:
    
    Mute / unmute toggle
    
    Volume control
    
    Full testimonial quote:
    
    No line clamp
    
    No text wrapping or truncation
    
    Display the entire quote
    
    Customer name
    
    Linked product name (clickable)
    
    Layout & Responsiveness
    
    Desktop: show 3â€“4 cards
    
    Mobile: show 1 card
    
    Fully responsive across all screen sizes
    
    Swipeable on mobile
    
    Cursor-draggable on desktop
    
    Customization Settings (Merchant Controls)
    
    Total testimonials: 14
    
    Toggle individual testimonial slides ON / OFF
    
    Adjustable border radius for testimonial cards
    
    Adjustable media aspect ratio (image/video)
    
    Enable / disable:
    
    Auto-scroll
    
    Pause on hover
    
    Video controls
    
    Video source must accept Shopify-hosted media links only
    
    Design Style
    
    Minimal, luxury aesthetic
    
    White or soft neutral background
    
    Clean typography using theme body font
    
    No heavy borders
    
    Soft shadows or none
    
    Subtle spacing and refined motion
    
    Performance & Accessibility
    
    Fast-loading and optimized for performance
    
    Fully accessible:
    
    Keyboard navigable
    
    ARIA labels where required
    
    Focus states for interactive elements
    
    SEO-friendly markup, i need arrows to control the carousel, I need option to upload videos too
{% enddoc %}
{% assign ai_gen_id = block.id | replace: '_', '' | downcase %}

{% style %}
  .ai-testimonial-carousel-{{ ai_gen_id }} {
    display: block;
    width: 100%;
    padding: 60px 20px;
    background-color: {{ block.settings.background_color }};
    overflow: hidden;
  }

  .ai-testimonial-carousel__header-{{ ai_gen_id }} {
    text-align: center;
    margin-bottom: 48px;
    max-width: 800px;
    margin-left: auto;
    margin-right: auto;
  }

  .ai-testimonial-carousel__headline-{{ ai_gen_id }} {
    font-size: {{ block.settings.headline_size }}px;
    color: {{ block.settings.text_color }};
    margin: 0 0 12px 0;
    font-weight: 400;
    letter-spacing: -0.02em;
  }

  .ai-testimonial-carousel__subheading-{{ ai_gen_id }} {
    font-size: {{ block.settings.subheading_size }}px;
    color: {{ block.settings.text_color }};
    opacity: 0.7;
    margin: 0;
    font-weight: 300;
  }

  .ai-testimonial-carousel__carousel-container-{{ ai_gen_id }} {
    position: relative;
    max-width: 1400px;
    margin: 0 auto;
  }

  .ai-testimonial-carousel__track-wrapper-{{ ai_gen_id }} {
    position: relative;
    overflow: hidden;
    cursor: grab;
    user-select: none;
  }

  .ai-testimonial-carousel__track-wrapper-{{ ai_gen_id }}:active {
    cursor: grabbing;
  }

  .ai-testimonial-carousel__track-{{ ai_gen_id }} {
    display: flex;
    gap: {{ block.settings.card_gap }}px;
    transition: transform 0.3s ease-out;
    will-change: transform;
  }

  .ai-testimonial-carousel__track-{{ ai_gen_id }}.is-animating {
    transition: transform 0.5s linear;
  }

  .ai-testimonial-carousel__card-{{ ai_gen_id }} {
    flex: 0 0 auto;
    width: calc((100% - {{ block.settings.card_gap | times: 2 }}px) / 3);
    background-color: {{ block.settings.card_background }};
    border-radius: {{ block.settings.card_border_radius }}px;
    padding: 32px;
    box-shadow: {{ block.settings.card_shadow }};
    display: flex;
    flex-direction: column;
    gap: 20px;
  }

  .ai-testimonial-carousel__nav-arrow-{{ ai_gen_id }} {
    position: absolute;
    top: 50%;
    transform: translateY(-50%);
    width: {{ block.settings.arrow_size }}px;
    height: {{ block.settings.arrow_size }}px;
    border-radius: 50%;
    background-color: {{ block.settings.arrow_background }};
    border: none;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    z-index: 10;
    transition: all 0.3s ease;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
  }

  .ai-testimonial-carousel__nav-arrow-{{ ai_gen_id }}:hover {
    background-color: {{ block.settings.arrow_hover_background }};
    transform: translateY(-50%) scale(1.1);
  }

  .ai-testimonial-carousel__nav-arrow-{{ ai_gen_id }}:disabled {
    opacity: 0.3;
    cursor: not-allowed;
  }

  .ai-testimonial-carousel__nav-arrow-{{ ai_gen_id }}:disabled:hover {
    transform: translateY(-50%) scale(1);
  }

  .ai-testimonial-carousel__nav-arrow-{{ ai_gen_id }} svg {
    width: 20px;
    height: 20px;
    stroke: {{ block.settings.arrow_color }};
  }

  .ai-testimonial-carousel__nav-arrow--prev-{{ ai_gen_id }} {
    left: -{{ block.settings.arrow_size | divided_by: 2 }}px;
  }

  .ai-testimonial-carousel__nav-arrow--next-{{ ai_gen_id }} {
    right: -{{ block.settings.arrow_size | divided_by: 2 }}px;
  }

  .ai-testimonial-carousel__media-wrapper-{{ ai_gen_id }} {
    position: relative;
    width: 100%;
    aspect-ratio: {{ block.settings.media_aspect_ratio }};
    border-radius: {{ block.settings.media_border_radius }}px;
    overflow: hidden;
    background-color: #f5f5f5;
  }

  .ai-testimonial-carousel__image-{{ ai_gen_id }} {
    width: 100%;
    height: 100%;
    object-fit: cover;
  }

  .ai-testimonial-carousel__video-{{ ai_gen_id }} {
    width: 100%;
    height: 100%;
    object-fit: cover;
  }

  .ai-testimonial-carousel__video-controls-{{ ai_gen_id }} {
    position: absolute;
    bottom: 12px;
    right: 12px;
    display: flex;
    gap: 8px;
    z-index: 2;
  }

  .ai-testimonial-carousel__video-btn-{{ ai_gen_id }} {
    width: 36px;
    height: 36px;
    border-radius: 50%;
    background-color: rgba(255, 255, 255, 0.9);
    border: none;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: background-color 0.2s ease;
  }

  .ai-testimonial-carousel__video-btn-{{ ai_gen_id }}:hover {
    background-color: rgba(255, 255, 255, 1);
  }

  .ai-testimonial-carousel__video-btn-{{ ai_gen_id }} svg {
    width: 16px;
    height: 16px;
  }

  .ai-testimonial-carousel__volume-slider-{{ ai_gen_id }} {
    width: 60px;
    height: 4px;
    background: rgba(255, 255, 255, 0.3);
    border-radius: 2px;
    position: relative;
    cursor: pointer;
    align-self: center;
  }

  .ai-testimonial-carousel__volume-fill-{{ ai_gen_id }} {
    height: 100%;
    background: rgba(0, 0, 0, 0.7);
    border-radius: 2px;
    width: 100%;
    transition: width 0.1s ease;
  }

  .ai-testimonial-carousel__quote-{{ ai_gen_id }} {
    font-size: {{ block.settings.quote_size }}px;
    line-height: 1.6;
    color: {{ block.settings.text_color }};
    margin: 0;
    font-weight: 300;
    white-space: normal;
    word-wrap: break-word;
  }

  .ai-testimonial-carousel__customer-info-{{ ai_gen_id }} {
    display: flex;
    flex-direction: column;
    gap: 4px;
    margin-top: auto;
  }

  .ai-testimonial-carousel__customer-name-{{ ai_gen_id }} {
    font-size: {{ block.settings.name_size }}px;
    color: {{ block.settings.text_color }};
    font-weight: 500;
    margin: 0;
  }

  .ai-testimonial-carousel__product-link-{{ ai_gen_id }} {
    font-size: {{ block.settings.product_link_size }}px;
    color: {{ block.settings.link_color }};
    text-decoration: none;
    transition: opacity 0.2s ease;
  }

  .ai-testimonial-carousel__product-link-{{ ai_gen_id }}:hover {
    opacity: 0.7;
  }

  .ai-testimonial-carousel__placeholder-{{ ai_gen_id }} {
    width: 100%;
    height: 100%;
    display: flex;
    align-items: center;
    justify-content: center;
    background-color: #f5f5f5;
  }

  .ai-testimonial-carousel__placeholder-{{ ai_gen_id }} svg {
    width: 60%;
    height: 60%;
    opacity: 0.3;
  }

  @media screen and (max-width: 989px) {
    .ai-testimonial-carousel__card-{{ ai_gen_id }} {
      width: calc((100% - {{ block.settings.card_gap }}px) / 2);
    }

    .ai-testimonial-carousel__nav-arrow--prev-{{ ai_gen_id }} {
      left: 10px;
    }

    .ai-testimonial-carousel__nav-arrow--next-{{ ai_gen_id }} {
      right: 10px;
    }
  }

  @media screen and (max-width: 749px) {
    .ai-testimonial-carousel-{{ ai_gen_id }} {
      padding: 40px 16px;
    }

    .ai-testimonial-carousel__header-{{ ai_gen_id }} {
      margin-bottom: 32px;
    }

    .ai-testimonial-carousel__headline-{{ ai_gen_id }} {
      font-size: {{ block.settings.headline_size | times: 0.7 }}px;
    }

    .ai-testimonial-carousel__subheading-{{ ai_gen_id }} {
      font-size: {{ block.settings.subheading_size | times: 0.85 }}px;
    }

    .ai-testimonial-carousel__card-{{ ai_gen_id }} {
      width: 100%;
      padding: 24px;
    }

    .ai-testimonial-carousel__quote-{{ ai_gen_id }} {
      font-size: {{ block.settings.quote_size | times: 0.9 }}px;
    }

    .ai-testimonial-carousel__nav-arrow-{{ ai_gen_id }} {
      width: {{ block.settings.arrow_size | times: 0.8 }}px;
      height: {{ block.settings.arrow_size | times: 0.8 }}px;
    }

    .ai-testimonial-carousel__nav-arrow-{{ ai_gen_id }} svg {
      width: 16px;
      height: 16px;
    }
  }
{% endstyle %}

<testimonial-carousel-{{ ai_gen_id }}
  class="ai-testimonial-carousel-{{ ai_gen_id }}"
  data-auto-scroll="{{ block.settings.enable_auto_scroll }}"
  data-pause-on-hover="{{ block.settings.pause_on_hover }}"
  data-scroll-speed="{{ block.settings.scroll_speed }}"
  data-show-arrows="{{ block.settings.show_arrows }}"
  {{ block.shopify_attributes }}
>
  <div class="ai-testimonial-carousel__header-{{ ai_gen_id }}">
    {% if block.settings.headline != blank %}
      <h2 class="ai-testimonial-carousel__headline-{{ ai_gen_id }}">{{ block.settings.headline }}</h2>
    {% endif %}
    {% if block.settings.subheading != blank %}
      <p class="ai-testimonial-carousel__subheading-{{ ai_gen_id }}">{{ block.settings.subheading }}</p>
    {% endif %}
  </div>

  <div class="ai-testimonial-carousel__carousel-container-{{ ai_gen_id }}">
    {% if block.settings.show_arrows %}
      <button
        class="ai-testimonial-carousel__nav-arrow-{{ ai_gen_id }} ai-testimonial-carousel__nav-arrow--prev-{{ ai_gen_id }}"
        data-nav-prev
        aria-label="Previous testimonial"
      >
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <polyline points="15 18 9 12 15 6"></polyline>
        </svg>
      </button>

      <button
        class="ai-testimonial-carousel__nav-arrow-{{ ai_gen_id }} ai-testimonial-carousel__nav-arrow--next-{{ ai_gen_id }}"
        data-nav-next
        aria-label="Next testimonial"
      >
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <polyline points="9 18 15 12 9 6"></polyline>
        </svg>
      </button>
    {% endif %}

    <div class="ai-testimonial-carousel__track-wrapper-{{ ai_gen_id }}">
      <div class="ai-testimonial-carousel__track-{{ ai_gen_id }}">
        {% for i in (1..14) %}
          {% liquid
            assign enabled_key = 'testimonial_' | append: i | append: '_enabled'
            assign image_key = 'testimonial_' | append: i | append: '_image'
            assign video_key = 'testimonial_' | append: i | append: '_video'
            assign quote_key = 'testimonial_' | append: i | append: '_quote'
            assign name_key = 'testimonial_' | append: i | append: '_name'
            assign product_key = 'testimonial_' | append: i | append: '_product'

            assign is_enabled = block.settings[enabled_key]
            assign image = block.settings[image_key]
            assign video = block.settings[video_key]
            assign quote = block.settings[quote_key]
            assign name = block.settings[name_key]
            assign product = block.settings[product_key]
          %}

          {% if is_enabled %}
            <div class="ai-testimonial-carousel__card-{{ ai_gen_id }}" data-card-index="{{ i }}">
              <div class="ai-testimonial-carousel__media-wrapper-{{ ai_gen_id }}">
                {% if video != blank %}
                  <video
                    class="ai-testimonial-carousel__video-{{ ai_gen_id }}"
                    src="{{ video.sources[1].url }}"
                    playsinline
                    loop
                    muted
                    data-video-element
                  ></video>
                  {% if block.settings.show_video_controls %}
                    <div class="ai-testimonial-carousel__video-controls-{{ ai_gen_id }}">
                      <button
                        class="ai-testimonial-carousel__video-btn-{{ ai_gen_id }}"
                        data-mute-toggle
                        aria-label="Toggle mute"
                      >
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" data-muted-icon>
                          <polygon points="11 5 6 9 2 9 2 15 6 15 11 19 11 5"></polygon>
                          <line x1="23" y1="9" x2="17" y2="15"></line>
                          <line x1="17" y1="9" x2="23" y2="15"></line>
                        </svg>
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" data-unmuted-icon style="display: none;">
                          <polygon points="11 5 6 9 2 9 2 15 6 15 11 19 11 5"></polygon>
                          <path d="M19.07 4.93a10 10 0 0 1 0 14.14"></path>
                          <path d="M15.54 8.46a5 5 0 0 1 0 7.07"></path>
                        </svg>
                      </button>
                      <div class="ai-testimonial-carousel__volume-slider-{{ ai_gen_id }}" data-volume-slider>
                        <div class="ai-testimonial-carousel__volume-fill-{{ ai_gen_id }}" data-volume-fill></div>
                      </div>
                    </div>
                  {% endif %}
                {% elsif image != blank %}
                  <img
                    class="ai-testimonial-carousel__image-{{ ai_gen_id }}"
                    src="{{ image | image_url: width: 800 }}"
                    alt="{{ name | escape }}"
                    loading="lazy"
                    width="800"
                    height="800"
                  >
                {% else %}
                  <div class="ai-testimonial-carousel__placeholder-{{ ai_gen_id }}">
                    {{ 'image' | placeholder_svg_tag }}
                  </div>
                {% endif %}
              </div>

              {% if quote != blank %}
                <p class="ai-testimonial-carousel__quote-{{ ai_gen_id }}">{{ quote }}</p>
              {% endif %}

              <div class="ai-testimonial-carousel__customer-info-{{ ai_gen_id }}">
                {% if name != blank %}
                  <p class="ai-testimonial-carousel__customer-name-{{ ai_gen_id }}">{{ name }}</p>
                {% endif %}
                {% if product != blank %}
                  <a
                    href="{{ product.url }}"
                    class="ai-testimonial-carousel__product-link-{{ ai_gen_id }}"
                  >
                    {{ product.title }}
                  </a>
                {% endif %}
              </div>
            </div>
          {% endif %}
        {% endfor %}
      </div>
    </div>
  </div>
</testimonial-carousel-{{ ai_gen_id }}>

<script>
  (function() {
    class TestimonialCarousel{{ ai_gen_id }} extends HTMLElement {
      constructor() {
        super();
        this.track = this.querySelector('.ai-testimonial-carousel__track-{{ ai_gen_id }}');
        this.trackWrapper = this.querySelector('.ai-testimonial-carousel__track-wrapper-{{ ai_gen_id }}');
        this.cards = Array.from(this.querySelectorAll('.ai-testimonial-carousel__card-{{ ai_gen_id }}'));
        this.prevBtn = this.querySelector('[data-nav-prev]');
        this.nextBtn = this.querySelector('[data-nav-next]');
        this.autoScroll = this.dataset.autoScroll === 'true';
        this.pauseOnHover = this.dataset.pauseOnHover === 'true';
        this.scrollSpeed = parseFloat(this.dataset.scrollSpeed) || 1;
        this.showArrows = this.dataset.showArrows === 'true';
        this.isDragging = false;
        this.startX = 0;
        this.scrollLeft = 0;
        this.animationId = null;
        this.currentTranslate = 0;
        this.isPaused = false;
      }

      connectedCallback() {
        this.cloneCards();
        this.setupDragScroll();
        this.setupVideoControls();
        if (this.showArrows) {
          this.setupArrowNavigation();
        }
        if (this.autoScroll) {
          this.startAutoScroll();
        }
        if (this.pauseOnHover) {
          this.setupHoverPause();
        }
      }

      disconnectedCallback() {
        this.stopAutoScroll();
      }

      cloneCards() {
        const clones = this.cards.map(card => card.cloneNode(true));
        clones.forEach(clone => this.track.appendChild(clone));
        const secondClones = this.cards.map(card => card.cloneNode(true));
        secondClones.forEach(clone => this.track.appendChild(clone));
      }

      setupArrowNavigation() {
        if (this.prevBtn) {
          this.prevBtn.addEventListener('click', () => {
            this.navigateCarousel('prev');
          });
        }

        if (this.nextBtn) {
          this.nextBtn.addEventListener('click', () => {
            this.navigateCarousel('next');
          });
        }
      }

      navigateCarousel(direction) {
        this.stopAutoScroll();
        
        const cardWidth = this.cards[0].offsetWidth;
        const gap = parseInt(getComputedStyle(this.track).gap) || 0;
        const moveDistance = cardWidth + gap;

        if (direction === 'next') {
          this.currentTranslate -= moveDistance;
        } else {
          this.currentTranslate += moveDistance;
        }

        this.track.style.transition = 'transform 0.5s ease';
        this.track.style.transform = `translateX(${this.currentTranslate}px)`;

        setTimeout(() => {
          this.checkLoop();
          this.track.style.transition = '';
        }, 500);

        if (this.autoScroll) {
          setTimeout(() => {
            if (!this.isDragging && !this.isPaused) {
              this.startAutoScroll();
            }
          }, 3000);
        }
      }

      setupDragScroll() {
        let velocity = 0;
        let lastX = 0;
        let lastTime = Date.now();

        this.trackWrapper.addEventListener('mousedown', (e) => {
          this.isDragging = true;
          this.startX = e.pageX - this.trackWrapper.offsetLeft;
          this.scrollLeft = this.currentTranslate;
          this.trackWrapper.style.cursor = 'grabbing';
          this.stopAutoScroll();
          lastX = e.pageX;
          lastTime = Date.now();
          velocity = 0;
        });

        this.trackWrapper.addEventListener('touchstart', (e) => {
          this.isDragging = true;
          this.startX = e.touches[0].pageX - this.trackWrapper.offsetLeft;
          this.scrollLeft = this.currentTranslate;
          this.stopAutoScroll();
          lastX = e.touches[0].pageX;
          lastTime = Date.now();
          velocity = 0;
        }, { passive: true });

        const handleMove = (clientX) => {
          if (!this.isDragging) return;
          const x = clientX - this.trackWrapper.offsetLeft;
          const walk = (x - this.startX) * 1.5;
          this.currentTranslate = this.scrollLeft + walk;
          this.track.style.transform = `translateX(${this.currentTranslate}px)`;

          const now = Date.now();
          const dt = now - lastTime;
          if (dt > 0) {
            velocity = (clientX - lastX) / dt;
          }
          lastX = clientX;
          lastTime = now;
        };

        this.trackWrapper.addEventListener('mousemove', (e) => {
          handleMove(e.pageX);
        });

        this.trackWrapper.addEventListener('touchmove', (e) => {
          handleMove(e.touches[0].pageX);
        }, { passive: true });

        const handleEnd = () => {
          if (!this.isDragging) return;
          this.isDragging = false;
          this.trackWrapper.style.cursor = 'grab';

          if (Math.abs(velocity) > 0.1) {
            this.applyMomentum(velocity);
          }

          this.checkLoop();

          if (this.autoScroll) {
            setTimeout(() => {
              if (!this.isDragging) {
                this.startAutoScroll();
              }
            }, 1000);
          }
        };

        this.trackWrapper.addEventListener('mouseup', handleEnd);
        this.trackWrapper.addEventListener('mouseleave', handleEnd);
        this.trackWrapper.addEventListener('touchend', handleEnd);
      }

      applyMomentum(initialVelocity) {
        let velocity = initialVelocity * 300;
        const friction = 0.95;

        const animate = () => {
          velocity *= friction;
          this.currentTranslate += velocity;
          this.track.style.transform = `translateX(${this.currentTranslate}px)`;

          if (Math.abs(velocity) > 0.5) {
            requestAnimationFrame(animate);
          } else {
            this.checkLoop();
          }
        };

        animate();
      }

      startAutoScroll() {
        if (this.isPaused) return;
        this.track.classList.add('is-animating');
        const scroll = () => {
          if (!this.isDragging && !this.isPaused) {
            this.currentTranslate -= this.scrollSpeed;
            this.track.style.transform = `translateX(${this.currentTranslate}px)`;
            this.checkLoop();
            this.animationId = requestAnimationFrame(scroll);
          }
        };
        this.animationId = requestAnimationFrame(scroll);
      }

      stopAutoScroll() {
        if (this.animationId) {
          cancelAnimationFrame(this.animationId);
          this.animationId = null;
        }
        this.track.classList.remove('is-animating');
      }

      checkLoop() {
        const trackWidth = this.track.scrollWidth / 3;
        if (this.currentTranslate <= -trackWidth) {
          this.currentTranslate += trackWidth;
          this.track.style.transition = 'none';
          this.track.style.transform = `translateX(${this.currentTranslate}px)`;
          requestAnimationFrame(() => {
            this.track.style.transition = '';
          });
        } else if (this.currentTranslate > 0) {
          this.currentTranslate -= trackWidth;
          this.track.style.transition = 'none';
          this.track.style.transform = `translateX(${this.currentTranslate}px)`;
          requestAnimationFrame(() => {
            this.track.style.transition = '';
          });
        }
      }

      setupHoverPause() {
        this.trackWrapper.addEventListener('mouseenter', () => {
          this.isPaused = true;
          this.stopAutoScroll();
        });

        this.trackWrapper.addEventListener('mouseleave', () => {
          this.isPaused = false;
          if (this.autoScroll && !this.isDragging) {
            this.startAutoScroll();
          }
        });
      }

      setupVideoControls() {
        this.cards.forEach(card => {
          const video = card.querySelector('[data-video-element]');
          if (!video) return;

          const muteToggle = card.querySelector('[data-mute-toggle]');
          const volumeSlider = card.querySelector('[data-volume-slider]');
          const volumeFill = card.querySelector('[data-volume-fill]');
          const mutedIcon = card.querySelector('[data-muted-icon]');
          const unmutedIcon = card.querySelector('[data-unmuted-icon]');

          const observer = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
              if (entry.isIntersecting) {
                video.play().catch(() => {});
              } else {
                video.pause();
              }
            });
          }, { threshold: 0.5 });

          observer.observe(card);

          if (muteToggle) {
            muteToggle.addEventListener('click', (e) => {
              e.preventDefault();
              video.muted = !video.muted;
              if (video.muted) {
                mutedIcon.style.display = 'block';
                unmutedIcon.style.display = 'none';
                volumeFill.style.width = '0%';
              } else {
                mutedIcon.style.display = 'none';
                unmutedIcon.style.display = 'block';
                volumeFill.style.width = (video.volume * 100) + '%';
              }
            });
          }

          if (volumeSlider) {
            volumeSlider.addEventListener('click', (e) => {
              e.preventDefault();
              const rect = volumeSlider.getBoundingClientRect();
              const x = e.clientX - rect.left;
              const percentage = Math.max(0, Math.min(1, x / rect.width));
              video.volume = percentage;
              volumeFill.style.width = (percentage * 100) + '%';
              if (percentage > 0) {
                video.muted = false;
                mutedIcon.style.display = 'none';
                unmutedIcon.style.display = 'block';
              }
            });
          }
        });
      }
    }

    customElements.define('testimonial-carousel-{{ ai_gen_id }}', TestimonialCarousel{{ ai_gen_id }});
  })();
</script>

{% schema %}
{
  "name": "Testimonial carousel",
  "tag": null,
  "settings": [
    {
      "type": "header",
      "content": "Header"
    },
    {
      "type": "text",
      "id": "headline",
      "label": "Headline",
      "default": "What Our Customers Say"
    },
    {
      "type": "range",
      "id": "headline_size",
      "label": "Headline size",
      "min": 20,
      "max": 72,
      "step": 2,
      "unit": "px",
      "default": 48
    },
    {
      "type": "text",
      "id": "subheading",
      "label": "Subheading",
      "default": "Real stories from real customers"
    },
    {
      "type": "range",
      "id": "subheading_size",
      "label": "Subheading size",
      "min": 12,
      "max": 32,
      "step": 1,
      "unit": "px",
      "default": 16
    },
    {
      "type": "header",
      "content": "Carousel settings"
    },
    {
      "type": "checkbox",
      "id": "enable_auto_scroll",
      "label": "Enable auto-scroll",
      "default": true
    },
    {
      "type": "range",
      "id": "scroll_speed",
      "label": "Auto-scroll speed",
      "min": 0.5,
      "max": 3,
      "step": 0.5,
      "default": 1
    },
    {
      "type": "checkbox",
      "id": "pause_on_hover",
      "label": "Pause on hover",
      "default": true
    },
    {
      "type": "header",
      "content": "Navigation arrows"
    },
    {
      "type": "checkbox",
      "id": "show_arrows",
      "label": "Show navigation arrows",
      "default": true
    },
    {
      "type": "range",
      "id": "arrow_size",
      "label": "Arrow size",
      "min": 32,
      "max": 72,
      "step": 4,
      "unit": "px",
      "default": 48
    },
    {
      "type": "color",
      "id": "arrow_background",
      "label": "Arrow background",
      "default": "#ffffff"
    },
    {
      "type": "color",
      "id": "arrow_hover_background",
      "label": "Arrow hover background",
      "default": "#f5f5f5"
    },
    {
      "type": "color",
      "id": "arrow_color",
      "label": "Arrow color",
      "default": "#000000"
    },
    {
      "type": "header",
      "content": "Card style"
    },
    {
      "type": "color",
      "id": "background_color",
      "label": "Background",
      "default": "#ffffff"
    },
    {
      "type": "color",
      "id": "card_background",
      "label": "Card background",
      "default": "#fafafa"
    },
    {
      "type": "range",
      "id": "card_border_radius",
      "label": "Card border radius",
      "min": 0,
      "max": 40,
      "step": 2,
      "unit": "px",
      "default": 12
    },
    {
      "type": "range",
      "id": "card_gap",
      "label": "Gap between cards",
      "min": 12,
      "max": 48,
      "step": 4,
      "unit": "px",
      "default": 24
    },
    {
      "type": "select",
      "id": "card_shadow",
      "label": "Card shadow",
      "options": [
        {
          "value": "none",
          "label": "None"
        },
        {
          "value": "0 1px 3px rgba(0,0,0,0.05)",
          "label": "Subtle"
        },
        {
          "value": "0 4px 12px rgba(0,0,0,0.08)",
          "label": "Medium"
        },
        {
          "value": "0 8px 24px rgba(0,0,0,0.12)",
          "label": "Strong"
        }
      ],
      "default": "0 4px 12px rgba(0,0,0,0.08)"
    },
    {
      "type": "header",
      "content": "Media settings"
    },
    {
      "type": "select",
      "id": "media_aspect_ratio",
      "label": "Media aspect ratio",
      "options": [
        {
          "value": "1 / 1",
          "label": "Square (1:1)"
        },
        {
          "value": "4 / 3",
          "label": "Landscape (4:3)"
        },
        {
          "value": "16 / 9",
          "label": "Wide (16:9)"
        },
        {
          "value": "3 / 4",
          "label": "Portrait (3:4)"
        }
      ],
      "default": "1 / 1"
    },
    {
      "type": "range",
      "id": "media_border_radius",
      "label": "Media border radius",
      "min": 0,
      "max": 40,
      "step": 2,
      "unit": "px",
      "default": 8
    },
    {
      "type": "checkbox",
      "id": "show_video_controls",
      "label": "Show video controls",
      "default": true
    },
    {
      "type": "header",
      "content": "Typography"
    },
    {
      "type": "color",
      "id": "text_color",
      "label": "Text color",
      "default": "#000000"
    },
    {
      "type": "range",
      "id": "quote_size",
      "label": "Quote size",
      "min": 12,
      "max": 24,
      "step": 1,
      "unit": "px",
      "default": 16
    },
    {
      "type": "range",
      "id": "name_size",
      "label": "Name size",
      "min": 12,
      "max": 20,
      "step": 1,
      "unit": "px",
      "default": 14
    },
    {
      "type": "range",
      "id": "product_link_size",
      "label": "Product link size",
      "min": 10,
      "max": 18,
      "step": 1,
      "unit": "px",
      "default": 13
    },
    {
      "type": "color",
      "id": "link_color",
      "label": "Link color",
      "default": "#666666"
    },
    {
      "type": "header",
      "content": "Testimonial 1"
    },
    {
      "type": "checkbox",
      "id": "testimonial_1_enabled",
      "label": "Enable",
      "default": true
    },
    {
      "type": "image_picker",
      "id": "testimonial_1_image",
      "label": "Image"
    },
    {
      "type": "video",
      "id": "testimonial_1_video",
      "label": "Video"
    },
    {
      "type": "textarea",
      "id": "testimonial_1_quote",
      "label": "Quote",
      "default": "These are the most comfortable shoes I've ever owned. The quality is exceptional and they look amazing!"
    },
    {
      "type": "text",
      "id": "testimonial_1_name",
      "label": "Customer name",
      "default": "Sarah Johnson"
    },
    {
      "type": "product",
      "id": "testimonial_1_product",
      "label": "Product"
    },
    {
      "type": "header",
      "content": "Testimonial 2"
    },
    {
      "type": "checkbox",
      "id": "testimonial_2_enabled",
      "label": "Enable",
      "default": true
    },
    {
      "type": "image_picker",
      "id": "testimonial_2_image",
      "label": "Image"
    },
    {
      "type": "video",
      "id": "testimonial_2_video",
      "label": "Video"
    },
    {
      "type": "textarea",
      "id": "testimonial_2_quote",
      "label": "Quote",
      "default": "Absolutely love the craftsmanship. Worth every penny and I get compliments everywhere I go."
    },
    {
      "type": "text",
      "id": "testimonial_2_name",
      "label": "Customer name",
      "default": "Michael Chen"
    },
    {
      "type": "product",
      "id": "testimonial_2_product",
      "label": "Product"
    },
    {
      "type": "header",
      "content": "Testimonial 3"
    },
    {
      "type": "checkbox",
      "id": "testimonial_3_enabled",
      "label": "Enable",
      "default": true
    },
    {
      "type": "image_picker",
      "id": "testimonial_3_image",
      "label": "Image"
    },
    {
      "type": "video",
      "id": "testimonial_3_video",
      "label": "Video"
    },
    {
      "type": "textarea",
      "id": "testimonial_3_quote",
      "label": "Quote",
      "default": "The attention to detail is incredible. These shoes are a perfect blend of style and comfort."
    },
    {
      "type": "text",
      "id": "testimonial_3_name",
      "label": "Customer name",
      "default": "Emma Williams"
    },
    {
      "type": "product",
      "id": "testimonial_3_product",
      "label": "Product"
    },
    {
      "type": "header",
      "content": "Testimonial 4"
    },
    {
      "type": "checkbox",
      "id": "testimonial_4_enabled",
      "label": "Enable",
      "default": true
    },
    {
      "type": "image_picker",
      "id": "testimonial_4_image",
      "label": "Image"
    },
    {
      "type": "video",
      "id": "testimonial_4_video",
      "label": "Video"
    },
    {
      "type": "textarea",
      "id": "testimonial_4_quote",
      "label": "Quote"
    },
    {
      "type": "text",
      "id": "testimonial_4_name",
      "label": "Customer name"
    },
    {
      "type": "product",
      "id": "testimonial_4_product",
      "label": "Product"
    },
    {
      "type": "header",
      "content": "Testimonial 5"
    },
    {
      "type": "checkbox",
      "id": "testimonial_5_enabled",
      "label": "Enable",
      "default": false
    },
    {
      "type": "image_picker",
      "id": "testimonial_5_image",
      "label": "Image"
    },
    {
      "type": "video",
      "id": "testimonial_5_video",
      "label": "Video"
    },
    {
      "type": "textarea",
      "id": "testimonial_5_quote",
      "label": "Quote"
    },
    {
      "type": "text",
      "id": "testimonial_5_name",
      "label": "Customer name"
    },
    {
      "type": "product",
      "id": "testimonial_5_product",
      "label": "Product"
    },
    {
      "type": "header",
      "content": "Testimonial 6"
    },
    {
      "type": "checkbox",
      "id": "testimonial_6_enabled",
      "label": "Enable",
      "default": false
    },
    {
      "type": "image_picker",
      "id": "testimonial_6_image",
      "label": "Image"
    },
    {
      "type": "video",
      "id": "testimonial_6_video",
      "label": "Video"
    },
    {
      "type": "textarea",
      "id": "testimonial_6_quote",
      "label": "Quote"
    },
    {
      "type": "text",
      "id": "testimonial_6_name",
      "label": "Customer name"
    },
    {
      "type": "product",
      "id": "testimonial_6_product",
      "label": "Product"
    },
    {
      "type": "header",
      "content": "Testimonial 7"
    },
    {
      "type": "checkbox",
      "id": "testimonial_7_enabled",
      "label": "Enable",
      "default": false
    },
    {
      "type": "image_picker",
      "id": "testimonial_7_image",
      "label": "Image"
    },
    {
      "type": "video",
      "id": "testimonial_7_video",
      "label": "Video"
    },
    {
      "type": "textarea",
      "id": "testimonial_7_quote",
      "label": "Quote"
    },
    {
      "type": "text",
      "id": "testimonial_7_name",
      "label": "Customer name"
    },
    {
      "type": "product",
      "id": "testimonial_7_product",
      "label": "Product"
    },
    {
      "type": "header",
      "content": "Testimonial 8"
    },
    {
      "type": "checkbox",
      "id": "testimonial_8_enabled",
      "label": "Enable",
      "default": false
    },
    {
      "type": "image_picker",
      "id": "testimonial_8_image",
      "label": "Image"
    },
    {
      "type": "video",
      "id": "testimonial_8_video",
      "label": "Video"
    },
    {
      "type": "textarea",
      "id": "testimonial_8_quote",
      "label": "Quote"
    },
    {
      "type": "text",
      "id": "testimonial_8_name",
      "label": "Customer name"
    },
    {
      "type": "product",
      "id": "testimonial_8_product",
      "label": "Product"
    },
    {
      "type": "header",
      "content": "Testimonial 9"
    },
    {
      "type": "checkbox",
      "id": "testimonial_9_enabled",
      "label": "Enable",
      "default": false
    },
    {
      "type": "image_picker",
      "id": "testimonial_9_image",
      "label": "Image"
    },
    {
      "type": "video",
      "id": "testimonial_9_video",
      "label": "Video"
    },
    {
      "type": "textarea",
      "id": "testimonial_9_quote",
      "label": "Quote"
    },
    {
      "type": "text",
      "id": "testimonial_9_name",
      "label": "Customer name"
    },
    {
      "type": "product",
      "id": "testimonial_9_product",
      "label": "Product"
    },
    {
      "type": "header",
      "content": "Testimonial 10"
    },
    {
      "type": "checkbox",
      "id": "testimonial_10_enabled",
      "label": "Enable",
      "default": false
    },
    {
      "type": "image_picker",
      "id": "testimonial_10_image",
      "label": "Image"
    },
    {
      "type": "video",
      "id": "testimonial_10_video",
      "label": "Video"
    },
    {
      "type": "textarea",
      "id": "testimonial_10_quote",
      "label": "Quote"
    },
    {
      "type": "text",
      "id": "testimonial_10_name",
      "label": "Customer name"
    },
    {
      "type": "product",
      "id": "testimonial_10_product",
      "label": "Product"
    },
    {
      "type": "header",
      "content": "Testimonial 11"
    },
    {
      "type": "checkbox",
      "id": "testimonial_11_enabled",
      "label": "Enable",
      "default": false
    },
    {
      "type": "image_picker",
      "id": "testimonial_11_image",
      "label": "Image"
    },
    {
      "type": "video",
      "id": "testimonial_11_video",
      "label": "Video"
    },
    {
      "type": "textarea",
      "id": "testimonial_11_quote",
      "label": "Quote"
    },
    {
      "type": "text",
      "id": "testimonial_11_name",
      "label": "Customer name"
    },
    {
      "type": "product",
      "id": "testimonial_11_product",
      "label": "Product"
    },
    {
      "type": "header",
      "content": "Testimonial 12"
    },
    {
      "type": "checkbox",
      "id": "testimonial_12_enabled",
      "label": "Enable",
      "default": false
    },
    {
      "type": "image_picker",
      "id": "testimonial_12_image",
      "label": "Image"
    },
    {
      "type": "video",
      "id": "testimonial_12_video",
      "label": "Video"
    },
    {
      "type": "textarea",
      "id": "testimonial_12_quote",
      "label": "Quote"
    },
    {
      "type": "text",
      "id": "testimonial_12_name",
      "label": "Customer name"
    },
    {
      "type": "product",
      "id": "testimonial_12_product",
      "label": "Product"
    },
    {
      "type": "header",
      "content": "Testimonial 13"
    },
    {
      "type": "checkbox",
      "id": "testimonial_13_enabled",
      "label": "Enable",
      "default": false
    },
    {
      "type": "image_picker",
      "id": "testimonial_13_image",
      "label": "Image"
    },
    {
      "type": "video",
      "id": "testimonial_13_video",
      "label": "Video"
    },
    {
      "type": "textarea",
      "id": "testimonial_13_quote",
      "label": "Quote"
    },
    {
      "type": "text",
      "id": "testimonial_13_name",
      "label": "Customer name"
    },
    {
      "type": "product",
      "id": "testimonial_13_product",
      "label": "Product"
    },
    {
      "type": "header",
      "content": "Testimonial 14"
    },
    {
      "type": "checkbox",
      "id": "testimonial_14_enabled",
      "label": "Enable",
      "default": false
    },
    {
      "type": "image_picker",
      "id": "testimonial_14_image",
      "label": "Image"
    },
    {
      "type": "video",
      "id": "testimonial_14_video",
      "label": "Video"
    },
    {
      "type": "textarea",
      "id": "testimonial_14_quote",
      "label": "Quote"
    },
    {
      "type": "text",
      "id": "testimonial_14_name",
      "label": "Customer name"
    },
    {
      "type": "product",
      "id": "testimonial_14_product",
      "label": "Product"
    }
  ],
  "presets": [
    {
      "name": "Testimonial carousel"
    }
  ]
}
{% endschema %}
